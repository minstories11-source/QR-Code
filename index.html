<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <meta name="description" content="Free QR Code Generator with Database Support">
    <title>QR Generator Pro</title>
    
    <link rel="stylesheet" href="styles.css">
    
    <!-- Libraries from CDN -->
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>
</head>
<body>
    
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <h1>âš¡ QR Generator Pro</h1>
            <button id="theme-toggle" class="btn-icon" title="Toggle theme">ğŸŒ™</button>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="nav-tabs">
        <button class="tab active" data-tab="generate">Generate</button>
        <button class="tab" data-tab="scan">Scan</button>
        <button class="tab" data-tab="database">Database</button>
    </nav>

    <!-- Main Content -->
    <main class="main">

        <!-- ========== GENERATE TAB ========== -->
        <section id="generate-tab" class="tab-content active">
            
            <!-- Database Search Section - shows when database is loaded -->
            <div id="db-search-container" class="card hidden">
                <h2>ğŸ” Search Database</h2>
                <div class="form-group" style="margin-bottom: 0;">
                    <input type="text" id="db-search" placeholder="Type to search database...">
                    <div id="search-results" class="search-results"></div>
                </div>
                
                <!-- QR Result for Database - appears right under search -->
                <div id="db-qr-result" class="qr-result-inline hidden">
                    <div id="db-qr-display" class="qr-display"></div>
                    <p id="db-qr-data" class="text-muted text-center"></p>
                    <div class="btn-group">
                        <button id="db-download-png" class="btn btn-primary">ğŸ“¥ Download</button>
                        <button id="db-copy-qr" class="btn btn-secondary">ğŸ“‹ Copy</button>
                        <button id="db-print-qr" class="btn btn-secondary">ğŸ–¨ï¸ Print</button>
                    </div>
                </div>
            </div>
            
            <!-- Manual QR Generation -->
            <div class="card">
                <h2>Create QR Code</h2>
                
                <div class="form-group">
                    <label for="qr-input">Text or URL</label>
                    <textarea id="qr-input" rows="3" placeholder="Enter text or URL..."></textarea>
                    <small class="char-counter"><span id="char-count">0</span> / 2953</small>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="error-level">Error Correction</label>
                        <select id="error-level">
                            <option value="L">Low (7%)</option>
                            <option value="M" selected>Medium (15%)</option>
                            <option value="Q">High (25%)</option>
                            <option value="H">Maximum (30%)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="fg-color">Color</label>
                        <input type="color" id="fg-color" value="#000000">
                    </div>
                </div>

                <input type="color" id="bg-color" value="#ffffff" class="hidden">

                <button id="generate-btn" class="btn btn-primary btn-block">Generate QR Code</button>
                
                <!-- QR Result for Manual - appears right under button -->
                <div id="qr-result" class="qr-result-inline hidden">
                    <div id="qr-display" class="qr-display"></div>
                    <p id="qr-data-preview" class="text-muted text-center"></p>
                    <div class="btn-group">
                        <button id="download-png" class="btn btn-primary">ğŸ“¥ Download</button>
                        <button id="copy-qr" class="btn btn-secondary">ğŸ“‹ Copy</button>
                        <button id="print-qr" class="btn btn-secondary">ğŸ–¨ï¸ Print</button>
                    </div>
                </div>
            </div>

            <!-- History -->
            <div class="card">
                <h2>Recent History</h2>
                <div id="history-list" class="history-list">
                    <p class="text-muted">No history yet</p>
                </div>
                <button id="clear-history" class="btn btn-small btn-danger">Clear History</button>
            </div>
        </section>

        <!-- ========== SCAN TAB ========== -->
        <section id="scan-tab" class="tab-content">
            <div class="card">
                <h2>ğŸ“· Scan QR Code</h2>
                
                <div class="scanner-container">
                    <video id="scanner-video" autoplay playsinline></video>
                    <div class="scanner-overlay">
                        <div class="scanner-frame"></div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="camera-select">Camera</label>
                    <select id="camera-select">
                        <option>Loading cameras...</option>
                    </select>
                </div>

                <div class="divider">
                    <span>OR</span>
                </div>

                <div class="form-group">
                    <label for="scan-upload" class="btn btn-secondary btn-block">
                        ğŸ“ Upload Image
                    </label>
                    <input type="file" id="scan-upload" accept="image/*" class="hidden">
                </div>
            </div>

            <!-- Scan Result -->
            <div id="scan-result" class="card hidden">
                <h2>âœ… Scan Result</h2>
                <div id="scan-data" class="scan-data"></div>
                <div class="btn-group">
                    <button id="copy-scan" class="btn btn-primary">ğŸ“‹ Copy</button>
                    <button id="open-url" class="btn btn-secondary">ğŸ”— Open URL</button>
                    <button id="generate-from-scan" class="btn btn-secondary">âš¡ Make QR</button>
                </div>
            </div>

            <!-- Scan History -->
            <div class="card">
                <h2>Scan History</h2>
                <div id="scan-history" class="history-list">
                    <p class="text-muted">No scans yet</p>
                </div>
            </div>
        </section>

        <!-- ========== DATABASE TAB ========== -->
        <section id="database-tab" class="tab-content">
            <div class="card">
                <h2>ğŸ“¦ Upload Database</h2>
                
                <div class="upload-zone" id="db-drop-zone">
                    <div class="upload-icon">ğŸ“‚</div>
                    <p>Tap to upload CSV/TSV file</p>
                    <small class="help-text">Format: Label, ID, Description (optional)</small>
                    <input type="file" id="db-upload" accept=".csv,.tsv,.txt">
                </div>

                <div id="upload-status" class="status hidden"></div>
            </div>

            <!-- Load from URL -->
            <div class="card">
                <h2>ğŸŒ Load from URL</h2>
                <div class="form-group">
                    <input type="text" id="db-url" placeholder="https://example.com/database.json">
                    <button id="load-db-url" class="btn btn-secondary btn-block" style="margin-top: 8px;">Load Database</button>
                </div>
            </div>

            <!-- Loaded Databases -->
            <div class="card">
                <h2>ğŸ“‹ Your Databases</h2>
                <div id="db-list" class="db-list">
                    <p class="text-muted">No databases loaded</p>
                </div>
            </div>

            <!-- Active Database Info -->
            <div id="active-db-card" class="card hidden">
                <h2>âœ“ Active Database</h2>
                <p><strong id="active-db-name"></strong></p>
                <p id="active-db-info" class="text-muted"></p>
                <button id="export-db" class="btn btn-small btn-secondary">ğŸ“¤ Export JSON</button>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="footer">
        <p>QR Generator Pro by jureczk</p>
    </footer>

    <!-- Toast Notification -->
    <div id="toast" class="toast hidden"></div>

    <!-- App Script -->
    <script src="app.js"></script>
</body>
</html>
