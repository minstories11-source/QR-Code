<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <meta name="description" content="Free QR Code Generator with Database Support, Batch Generation, and Scanner">
    <title>QR Generator Pro</title>
    
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="icons/favicon.png" type="image/png">
    
    <!-- QR Code Library -->
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
    <!-- jsQR for scanning -->
    <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>
    <!-- jsPDF for PDF export -->
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
</head>
<body>
    
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <h1>‚ö° QR Generator Pro</h1>
            <button id="theme-toggle" class="btn-icon" title="Toggle theme">üåô</button>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="nav-tabs">
        <button class="tab active" data-tab="generate">Generate</button>
        <button class="tab" data-tab="batch">Batch</button>
        <button class="tab" data-tab="scan">Scan</button>
        <button class="tab" data-tab="database">Database</button>
    </nav>

    <!-- Main Content -->
    <main class="main">

        <!-- ========== GENERATE TAB ========== -->
        <section id="generate-tab" class="tab-content active">
            <div class="card">
                <h2>Create QR Code</h2>
                
                <div class="form-group">
                    <label for="qr-input">Text or URL</label>
                    <textarea id="qr-input" rows="3" placeholder="Enter text, URL, or search database..."></textarea>
                    <small class="char-counter"><span id="char-count">0</span> / 2953</small>
                </div>

                <!-- Database Search (shows when database loaded) -->
                <div id="db-search-container" class="form-group hidden">
                    <label for="db-search">Search Database</label>
                    <input type="text" id="db-search" placeholder="Type to search...">
                    <div id="search-results" class="search-results"></div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="error-level">Error Correction</label>
                        <select id="error-level">
                            <option value="L">Low (7%)</option>
                            <option value="M" selected>Medium (15%)</option>
                            <option value="Q">High (25%)</option>
                            <option value="H">Maximum (30%)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="qr-style">Style</label>
                        <select id="qr-style">
                            <option value="square">Square</option>
                            <option value="dots">Dots</option>
                            <option value="rounded">Rounded</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="fg-color">Foreground</label>
                        <input type="color" id="fg-color" value="#000000">
                    </div>
                    <div class="form-group">
                        <label for="bg-color">Background</label>
                        <input type="color" id="bg-color" value="#ffffff">
                    </div>
                </div>

                <div class="form-group">
                    <label for="template-select">Template</label>
                    <select id="template-select">
                        <option value="">No Template</option>
                        <option value="zone-blue">Zone Label - Blue</option>
                        <option value="zone-gradient">Zone Label - Gradient</option>
                        <option value="simple-border">Simple Border</option>
                    </select>
                </div>

                <button id="generate-btn" class="btn btn-primary btn-block">Generate QR Code</button>
            </div>

            <!-- QR Result -->
            <div id="qr-result" class="card hidden">
                <h2>Your QR Code</h2>
                <div id="qr-display" class="qr-display"></div>
                <p id="qr-data-preview" class="text-muted"></p>
                
                <div class="btn-group">
                    <button id="download-png" class="btn btn-primary">üì• PNG</button>
                    <button id="copy-qr" class="btn btn-secondary">üìã Copy</button>
                    <button id="print-qr" class="btn btn-secondary">üñ®Ô∏è Print</button>
                </div>

                <div id="scan-distance" class="info-box"></div>
            </div>

            <!-- History -->
            <div class="card">
                <h2>Recent History</h2>
                <div id="history-list" class="history-list">
                    <p class="text-muted">No history yet</p>
                </div>
                <button id="clear-history" class="btn btn-small btn-danger">Clear History</button>
            </div>
        </section>

        <!-- ========== BATCH TAB ========== -->
        <section id="batch-tab" class="tab-content">
            <div class="card">
                <h2>Batch Generation</h2>
                
                <div class="form-group">
                    <label for="batch-pattern">Pattern</label>
                    <input type="text" id="batch-pattern" placeholder="e.g., ZONE-{A-D}-{01-10}">
                    <small class="help-text">Use {1-10} for numbers, {A-Z} for letters, {item1|item2} for lists</small>
                </div>

                <div class="form-group">
                    <label for="batch-manual">Or Enter Manually (one per line)</label>
                    <textarea id="batch-manual" rows="4" placeholder="Item 1&#10;Item 2&#10;Item 3"></textarea>
                </div>

                <div class="form-group">
                    <label for="batch-template">Template</label>
                    <select id="batch-template">
                        <option value="">No Template</option>
                        <option value="zone-blue">Zone Label - Blue</option>
                        <option value="zone-gradient">Zone Label - Gradient</option>
                        <option value="simple-border">Simple Border</option>
                    </select>
                </div>

                <div class="btn-group">
                    <button id="preview-batch" class="btn btn-secondary">Preview</button>
                    <button id="generate-batch" class="btn btn-primary">Generate All</button>
                </div>
            </div>

            <!-- Batch Preview -->
            <div id="batch-preview" class="card hidden">
                <h2>Preview</h2>
                <pre id="batch-preview-list"></pre>
            </div>

            <!-- Batch Progress -->
            <div id="batch-progress" class="card hidden">
                <h2>Generating...</h2>
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill"></div>
                </div>
                <p id="progress-text">0%</p>
            </div>

            <!-- Batch Results -->
            <div id="batch-results" class="card hidden">
                <h2>Generated QR Codes</h2>
                <div id="batch-grid" class="batch-grid"></div>
                
                <div class="btn-group">
                    <button id="download-all-zip" class="btn btn-primary">üì• Download All</button>
                    <button id="download-pdf" class="btn btn-secondary">üìÑ PDF</button>
                    <button id="print-labels" class="btn btn-secondary">üè∑Ô∏è Print Labels</button>
                </div>

                <!-- Label Template Selection -->
                <div class="form-group">
                    <label>Label Template</label>
                    <div class="label-templates">
                        <button class="label-btn" data-template="avery-5160">Avery 5160<br><small>30 labels</small></button>
                        <button class="label-btn" data-template="avery-5163">Avery 5163<br><small>10 labels</small></button>
                        <button class="label-btn" data-template="avery-5167">Avery 5167<br><small>80 labels</small></button>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========== SCAN TAB ========== -->
        <section id="scan-tab" class="tab-content">
            <div class="card">
                <h2>Scan QR Code</h2>
                
                <div class="scanner-container">
                    <video id="scanner-video" autoplay playsinline></video>
                    <div class="scanner-overlay">
                        <div class="scanner-frame"></div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="camera-select">Camera</label>
                    <select id="camera-select">
                        <option>Loading cameras...</option>
                    </select>
                </div>

                <div class="divider">
                    <span>OR</span>
                </div>

                <div class="form-group">
                    <label for="scan-upload" class="btn btn-secondary btn-block upload-label">
                        üìÅ Upload Image
                    </label>
                    <input type="file" id="scan-upload" accept="image/*" class="hidden">
                </div>
            </div>

            <!-- Scan Result -->
            <div id="scan-result" class="card hidden">
                <h2>‚úÖ Scan Result</h2>
                <div id="scan-data" class="scan-data"></div>
                <div class="btn-group">
                    <button id="copy-scan" class="btn btn-primary">üìã Copy</button>
                    <button id="open-url" class="btn btn-secondary">üîó Open URL</button>
                    <button id="generate-from-scan" class="btn btn-secondary">‚ö° Generate QR</button>
                </div>
            </div>

            <!-- Scan History -->
            <div class="card">
                <h2>Scan History</h2>
                <div id="scan-history" class="history-list">
                    <p class="text-muted">No scans yet</p>
                </div>
            </div>
        </section>

        <!-- ========== DATABASE TAB ========== -->
        <section id="database-tab" class="tab-content">
            <div class="card">
                <h2>üì¶ Database Management</h2>
                
                <div class="upload-zone" id="db-drop-zone">
                    <div class="upload-icon">üìÇ</div>
                    <p>Drag & drop CSV/TSV file here</p>
                    <p class="text-muted">or</p>
                    <label for="db-upload" class="btn btn-primary">Browse Files</label>
                    <input type="file" id="db-upload" accept=".csv,.tsv,.txt" class="hidden">
                    <small class="help-text">Format: Label, ID, DisplayText (optional)</small>
                </div>

                <div id="upload-status" class="status hidden"></div>
            </div>

            <!-- QR Database Import -->
            <div class="card">
                <h2>üì± Import via QR Code</h2>
                <p class="text-muted">Scan a QR code containing a database URL to instantly load data.</p>
                <button id="scan-db-qr" class="btn btn-secondary btn-block">üì∑ Scan Database QR</button>
                
                <div class="divider"><span>OR</span></div>
                
                <div class="form-group">
                    <label for="db-url">Database URL</label>
                    <input type="text" id="db-url" placeholder="https://example.com/database.json">
                    <button id="load-db-url" class="btn btn-secondary btn-block">Load from URL</button>
                </div>
            </div>

            <!-- Loaded Databases -->
            <div class="card">
                <h2>Loaded Databases</h2>
                <div id="db-list" class="db-list">
                    <p class="text-muted">No databases loaded</p>
                </div>
            </div>

            <!-- Active Database Info -->
            <div id="active-db-card" class="card hidden">
                <h2>Active Database</h2>
                <p id="active-db-name"></p>
                <p id="active-db-info" class="text-muted"></p>
                <button id="export-db" class="btn btn-small btn-secondary">üì§ Export JSON</button>
                <button id="generate-db-qr" class="btn btn-small btn-secondary">üì± Generate Share QR</button>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="footer">
        <p>QR Generator Pro | <a href="https://github.com/YOUR_USERNAME/qr-generator" target="_blank">GitHub</a></p>
    </footer>

    <!-- Toast Notification -->
    <div id="toast" class="toast hidden"></div>

    <!-- App Script -->
    <script src="app.js"></script>
</body>
</html>
